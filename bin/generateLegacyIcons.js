const glob = require('glob');
const fs = require('fs-extra');
const path = require('path');
const kebabCase = require('lodash/kebabCase');

/**
 * Dist directory
 * @type {string}
 */
const DIST_DIR = '../src/icons/legacy';

const resolvePath = (...paths) => path.resolve(__dirname, ...paths);

module.exports = function() {
  const files = glob.sync(resolvePath('../node_modules/rsuite-icon-font/lib/*.js'));
  files.forEach(function generateComponent(svgPath, index) {
    const basename = path.basename(svgPath);
    const componentName = path.basename(basename, path.extname(basename));
    const kebabCaseName = kebabCase(componentName);
    console.log(`(${index + 1}/${files.length}) Generating ${componentName}.tsx ...`);
    fs.outputFileSync(
      resolvePath(DIST_DIR, `${componentName}.tsx`),
      `// Generated by script, don't edit it please.
import { createSvgIcon } from '../../IconBase';
import ${componentName}Svg from 'rsuite-icon-font/lib/${componentName}';

export default createSvgIcon({
  as: ${componentName}Svg,
  ariaLabel: '${kebabCaseName}',
  displayName: '${componentName}'
});`
    );
  });
};
